<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>Shenior Kurir | List Penghantaran</title>

	<!-- Main Styles -->
	<link rel="stylesheet" href="/styles/style.min.css">

	<!-- mCustomScrollbar -->
	<link rel="stylesheet" href="/plugin/mCustomScrollbar/jquery.mCustomScrollbar.min.css">

	<!-- Waves Effect -->
	<link rel="stylesheet" href="/plugin/waves/waves.min.css">

	<!-- Sweet Alert -->
	<link rel="stylesheet" href="/plugin/sweet-alert/sweetalert.css">

	<link rel="stylesheet" href="/fonts/fontello/fontello.css">

	<link rel="stylesheet" href="/fonts/material-design-iconic-font/css/material-design-iconic-font.min.css">
	<link rel="stylesheet" href="/fonts/material-design/css/materialdesignicons.css">

	<link rel="stylesheet" href="/plugin/datatables/media/css/dataTables.bootstrap.min.css">

	<!-- Toastr -->
	<link rel="stylesheet" href="/plugin/toastr/toastr.css">

	<!-- Select2 -->
	<link rel="stylesheet" href="/plugin/select2/css/select2.min.css">

	<!-- Timeline -->
	<!-- <link rel="stylesheet" href="/plugin/timeline/css/style.css"> -->

</head>

<body>
	<div class="main-menu">
		<header class="header">
			<a href="/admin" class="logo">Shenior Kurir</a>
			<button type="button" class="button-close fa fa-times js__menu_close"></button>
			<div class="user">
				<a href="#" class="avatar"><img src="/images/admin.png" alt=""><span class="status online"></span></a>
				<h5 class="name"><a href="#">Admin</a></h5>
				<h5 class="position">Admin</h5>

			</div>
			<!-- /.user -->
		</header>
		<!-- /.header -->
		<div class="content">

			<div class="navigation">
				<h5 class="title">Navigasi</h5>
				<!-- /.title -->
				<ul class="menu js__accordion">
					<li >
						<a class="waves-effect" href="/admin"><i class="menu-icon fa fa-home"></i><span>Halaman
								Utama</span></a>
					</li>

					<li>
						<a class="waves-effect" href="/admin/kurir"><i
								class="menu-icon ico mdi mdi-motorbike"></i><span>List Kurir</span></a>
					</li>

					<li>
                        <a class="waves-effect" href="/admin/user"><i class="menu-icon fa fa-users"></i><span>List
                                User</span></a>
                    </li>

					<li lass="current active">
						<a class="waves-effect" href="/admin/list" ><i
								class="menu-icon ico icon-table"></i><span>List Penghantaran</span></a>
					</li>


					<li class="current active">
						<a class="waves-effect" href="#" onclick="logout()"><i
								class="menu-icon ico icon-logout"></i><span>Logout</span></a>
					</li>
				</ul>

			</div>
			<!-- /.navigation -->
		</div>
		<!-- /.content -->
	</div>
	<!-- /.main-menu -->

	<div class="fixed-navbar">
		<div class="pull-left">
			<button type="button"
				class="menu-mobile-button glyphicon glyphicon-menu-hamburger js__menu_mobile"></button>
			<h1 class="page-title">List Penghantaran</h1>
			<!-- /.page-title -->
		</div>
		<!-- /.pull-left -->
		<div class="pull-right">


			<a href="#" class="ico-item ico icon-logout" onclick="logout()"></a>
		</div>
		<!-- /.pull-right -->
	</div>
	<!-- /.fixed-navbar -->

	<div id="wrapper">
		<div class="main-content">
			<div class="row">
				
				<div class="col-xs-12">
					<div class="box-content card">
						<h4 class="box-title">Form List Penghantaran</h4>
						<!-- /.box-title -->
						<div class="card-content">
							<div class="form-group text-center" id="text-tiada-pengiriman">
								<p>Tidak ada list penghantaran</p>
							</div>
							<div class="form-group" id="form-tb-paket">
								<table id="tb-paket" class="table table-striped table-bordered display"
									style="width:100%">

								</table>
							</div>
						</div>
					</div>
					<!-- /.box-content -->
				</div>
			</div>
			<footer class="footer">
				<ul class="list-inline">
					<li>Arifuddin Naawi Amanah Â© 2025.</li>
					<!-- <li><a href="#">Privacy</a></li>
				<li><a href="#">Terms</a></li>
				<li><a href="#">Help</a></li> -->
				</ul>
			</footer>
		</div>
		<!-- /.main-content -->
	</div><!--/#wrapper -->

	<div class="modal fade" id="modal-paket" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
							aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="modal-paket-title">Modal title</h4>
				</div>
				<form class="modal-body" id="form-modal">
					<div class="form-group">
						<!-- show the upload -->
						<div id="show-upload-gambar-paket" style="display: none">
							<center>
								<div id="preview-gambar-paket" style="height: 200px; width: 150px"></div>
							</center>
						</div>
					</div>
					<div class="form-group" id="form-gambar-paket">
						<!-- create upload -->
						<label for="modal-paket-nama">Photo Paket</label>
						<input type="file" class="form-control" id="gambar-paket" accept="image/*"
							onchange="showUpload(this, 'gambar-paket')">
					</div>

					<div class="form-group" id="div-nomor-resi" style="display: none">
						<label for="modal-paket-nomor-resi">Nomor Resi</label>
						<input type="text" class="form-control" id="nomor_resi">
					</div>

					<div class="form-group" id="div-waktu-dibuat" style="display: none">
						<label for="modal-paket-waktu-dibuat">Waktu Dibuat</label>
						<input type="text" class="form-control" id="waktu_dibuat">
					</div>

					<div class="form-group" id="div-status" style="display: none">
						<label for="modal-paket-div-status">Status</label>
						<input type="text" class="form-control" id="status">
					</div>

					<hr>
					<hr>


					<div class="form-group">
						<label for="modal-paket-nama-pengirim">Nama Pengirim</label>
						<input type="text" class="form-control" id="nama_pengirim" placeholder="Masukkan Nama Pengirim">
					</div>

					<div class="form-group">
						<label for="modal-paket-no-telpon-pengirim">No Telpon/HP Pengirim</label>
						<input type="text" class="form-control" id="no_telpon_pengirim" oninput="numberOnly(this)"
							maxlength="13" placeholder="Masukkan No Telpon/HP Pengirim">
					</div>

					<div class="form-group">
						<label for="modal-paket-alamat-pengirim">Alamat Pengirim</label>
						<textarea name="alamat_pengirim" class="form-control" id="alamat_pengirim"
							placeholder="Masukkan Alamat Pengirim" style="resize: none;"></textarea>
					</div>

					<hr>
					<hr>

					<div class="form-group">
						<label for="modal-paket-nama-penerima">Nama Penerima</label>
						<input type="text" class="form-control" id="nama_penerima" placeholder="Masukkan Nama Penerima">
					</div>

					<div class="form-group">
						<label for="modal-paket-no-telpon-penerima">No Telpon/HP Penerima</label>
						<input type="text" class="form-control" id="no_telpon_penerima" oninput="numberOnly(this)"
							maxlength="13" placeholder="Masukkan No Telpon/HP Penerima">
					</div>

					<div class="form-group">
						<label for="modal-paket-alamat-penerima">Alamat Penerima</label>
						<textarea name="alamat_penerima" class="form-control" id="alamat_penerima"
							placeholder="Masukkan Alamat Penerima" style="resize: none;"></textarea>
					</div>

					<hr>
					<hr>

					<div class="form-group" id="div-data-kurir">
						<label id="label-kurir-ditugaskan">Tugaskan Kurir</label>
						<div id="div-select-kurir">
							<select class="form-control" id="select-kurir" width="100%"></select>
						</div>
						<input type="text" class="form-control" id="input_kurir" style="display: none">
					</div>

					<hr>
					<hr>


					<div class="form-group">
						<label for="modal-paket-berat">Progress</label>
						<div class="activity-list">
						</div>
					</div>


				</form>
				<div class="modal-footer">
					<button type="button" class="btn btn-xs btn-default btn-sm waves-effect waves-light"
						data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-xs btn-danger btn-sm waves-effect waves-light"
						id="btn-batalkan-paket">Batalkan Pengiriman</button>
					<button type="button" class="btn btn-xs btn-primary btn-sm waves-effect waves-light"
						id="btn-tugaskan-kurir">Tugaskan Kurir</button>

				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="modal-kurir" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
							aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="modal-kurir-title">Modal title</h4>
				</div>
				<form class="modal-body" id="form-modal">
					<div class="form-group">
						<!-- show the upload -->
						<div id="show-upload-gambar-kurir" style="display: none">
							<center>
								<div id="preview-gambar-kurir" style="height: 200px; width: 150px"></div>
							</center>
						</div>
					</div>
					<div class="form-group" id="form-gambar-kurir">
						<!-- create upload -->
						<label for="modal-kurir-nama">Photo Kurir</label>
						<input type="file" class="form-control" id="gambar-kurir" accept="image/*"
							onchange="showUpload(this, 'gambar-kurir')">
					</div>

					<div class="form-group">
						<label for="modal-kurir-nama">Nama</label>
						<input type="text" class="form-control" id="nama-kurir" placeholder="Masukkan Nama">
					</div>
					<div class="form-group">
						<label for="modal-kurir-nama">No Telpon/HP</label>
						<input type="text" class="form-control" id="no_telpon-kurir" oninput="numberOnly(this)"
							maxlength="13" placeholder="Masukkan No Telpon/HP">
					</div>

					<div class="form-group">
						<label for="modal-kurir-nama">Jenis Kelamin</label>
						<select class="form-control" id="jenis-kelamin-kurir">
							<option value="" disabled selected>-Pilih Jenis Kelamin</option>
							<option value="Laki-laki">Laki-laki</option>
							<option value="Perempuan">Perempuan</option>
						</select>
					</div>
					<hr>
					<div class="form-group">
						<!-- show the upload -->
						<div id="show-upload-gambar-motor" style="display: none">
							<center>
								<div id="preview-gambar-motor" style="height: 200px; width: 150px"></div>
							</center>
						</div>
					</div>
					<div class="form-group" id="form-gambar-motor">
						<!-- create upload -->
						<label for="modal-kurir-nama">Photo Motor</label>
						<input type="file" class="form-control" id="gambar-motor" accept="image/*"
							onchange="showUpload(this, 'gambar-motor')">
					</div>
					<div class="form-group">
						<label for="modal-kurir-dd-motor">DD Motor</label>
						<input type="text" class="form-control" id="dd-motor-kurir" placeholder="Masukkan DD Motor">
					</div>




				</form>
				<div class="modal-footer">
					<button type="button" class="btn btn-default btn-sm waves-effect waves-light"
						id="button-close-modal-kurir">Close</button>
				</div>
			</div>
		</div>
	</div>
	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
		<script src="/script/html5shiv.min.js"></script>
		<script src="/script/respond.min.js"></script>
	<![endif]-->
	<!-- 
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="/scripts/jquery.min.js"></script>
	<script src="/scripts/modernizr.min.js"></script>
	<script src="/plugin/bootstrap/js/bootstrap.min.js"></script>
	<script src="/plugin/mCustomScrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
	<script src="/plugin/nprogress/nprogress.js"></script>
	<script src="/plugin/sweet-alert/sweetalert.min.js"></script>
	<script src="/plugin/waves/waves.min.js"></script>
	<!-- Full Screen Plugin -->
	<script src="/plugin/fullscreen/jquery.fullscreen-min.js"></script>

	<!-- Toastr -->
	<script src="/plugin/toastr/toastr.min.js"></script>

	<script src="/plugin/datatables/media/js/jquery.dataTables.min.js"></script>
	<script src="/plugin/datatables/media/js/dataTables.bootstrap.min.js"></script>
	<script src="/plugin/datatables/extensions/Responsive/js/dataTables.responsive.min.js"></script>

	<!-- <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script> -->

	<!-- Select2 -->
	<script src="/plugin/select2/js/select2.min.js"></script>

	<script src="/block/jquery.blockUI.js"></script>

	<script src="/scripts/main.min.js"></script>
	<script src="/my-js.js"></script>
	<script src="/socket-io/client-dist/socket.io.js"></script>
	<script src="/admin.js"></script>

	<script>

		function select_function() {
			$('#select-kurir').select2({
				placeholder: '-Sila Pilih Kurir-',
				width: '100%',
				ajax: {
					url: '/admin/check-kurir/tersedia',
					type: 'GET',
					dataType: 'json',
					delay: 250,
					processResults: function (data) {
						// make sure `data` is an array
						return {
							results: data.map(kurir => ({
								id: kurir._id + "-" + kurir.nama + "-" + kurir.no_telpon,
								text: kurir.nama
							}))
						};
					},
					cache: true
				}
			});
		}

		// select_function();


		function reloadTable() {
			// destroy table
			// $('#tb-kurir').DataTable().destroy();
			$('#tb-paket').DataTable({
				// responsive: true,
				scrollX: true,
				// order: [
				// 	[0, 'asc']
				// ],
				ajax: {
					url: '/admin/paket-all/',
					type: 'GET',
					timeout: 120000,
					dataSrc: function (data) {
						// console.log(data)
						if (data.length == 0) {
							$("#form-tb-paket").hide();
							$("#text-tiada-pengiriman").show();
						} else {
							$("#form-tb-paket").show();
							$("#text-tiada-pengiriman").hide();
						}
						return data.reverse();
					}
				},
				"sAjaxDataProp": "",
				"aoColumns": [
					// {
					// 	"mData": "_id",
					// 	"title": "No Resi",
					// 	"render": function (data, type, row) {
					// 		return data
					// 	}
					// },
					{
						"mData": "nama_pengirim",
						"title": "Nama Pengirim",
						"render": function (data, type, row) {
							return data
						}
					},
					{
						"mData": "nama_penerima",
						"title": "Nama Penerima",
						"render": function (data, type, row) {
							return data
						}
					},
					{
						"mData": "alamat_penerima",
						"title": "Alamat Penerima",
						"render": function (data, type, row) {
							return data
						}
					},
					{
						"mData": "status",
						"title": "Status",
						"render": function (data, type, row) {
							return data
						}
					},
					{
						"mData": null,
						"title": "Aksi",
						"render": function (data, type, row) {
							return `<button type='button' onclick='open_modal_paket("${data._id}")' title='Detail Pengiriman' class='btn btn-info btn-circle btn-sm waves-effect waves-light'><i class='ico zmdi zmdi-info'></i></button> `
						}
					}
				]

			})


		}

		reloadTable()

		async function open_modal_paket(id) {

			
			$.ajax({
				url: '/user/paket-detail/' + id,
				type: 'GET',
				timeout: 20000,
				beforeSend: function () {
					select_function();
					blockUI('Loading Data...');
				},
				complete: function () {
					$.unblockUI();
				},
				success: function (data) {
					// Handle the response here
					console.log(data.timeline);

					if (data.id_kurir != null && data.id_kurir != undefined && data.id_kurir != "") {
						// hide select kurir
						$("#div-select-kurir").hide();
						// show input_kurir
						$("#input_kurir").show();

						// hide batal button
						$("#btn-batalkan-paket").hide();

						// hide btn-tugaskan-kurir
						$("#btn-tugaskan-kurir").hide();
					} else {
						// show select kurir
						$("#div-select-kurir").show();
						// hide input_kurir
						$("#input_kurir").hide();
						// show batal button
						$("#btn-batalkan-paket").show();

						// show btn-tugaskan-kurir
						$("#btn-tugaskan-kurir").show();
					}

					// let waktu_dibuat = new Date(data.createdAt);

					$('#modal-paket-title').html('Form Detail Pengiriman Paket');

					// $("#id").val(data._id);
					$("#div-nomor-resi").show();
					$("#nomor_resi").val(data._id);
					$("#div-waktu-dibuat").show();
					$("#waktu_dibuat").val(formatToMakassar(data.createdAt));
					$("#div-status").show();
					$("#status").val(data.status);
					$("#no_telpon_pengirim").val(data.no_telpon_pengirim);
					$("#nama_pengirim").val(data.nama_pengirim);
					$("#alamat_pengirim").val(data.alamat_pengirim);
					$("#no_telpon_penerima").val(data.no_telpon_penerima);
					$("#nama_penerima").val(data.nama_penerima);
					$("#alamat_penerima").val(data.alamat_penerima);
					// $("#gambar-paket").attr("src", data.gambar_paket);

					var img = document.createElement('img');
					img.src = "/user/paket-detail/" + data._id + "/" + data.gambar_paket;
					// make the width 150px and height 150px
					img.style.width = '150px';
					img.style.height = '150px';
					const id = 'show-upload-gambar-paket'

					const id_preview = 'preview-gambar-paket'
					// Get the preview div
					var previewDiv = document.getElementById(`${id_preview}`);
					$('#' + id).show();

					// Clear any existing content in the preview div
					previewDiv.innerHTML = '';

					// Append the image to the preview div
					previewDiv.appendChild(img);

					// disable all input in #form-modal
					$("#form-gambar-paket").hide();

					$('#form-modal :input').prop('disabled', true);

					// make select enabled
					$("#select-kurir").prop('disabled', false);


					let activity_html = '';
					for (let i = data.timeline.length - 1; i >= 0; i--) {
						let colornya = 'bg-info';

						if (data.timeline[i].status == 'Paket Telah Diterima Penerima') {
							colornya = 'bg-success';
						}

						if (data.timeline[i].status.includes('Dibatalkan')) {
							colornya = 'bg-danger';
						}

						activity_html += `<div class="activity-item">
							<div class="bar ${colornya}">
							<div class="dot ${colornya}"></div>
							</div>
							<div class="content">
							<div class="date">${formatToMakassar(data.timeline[i].waktu)}</div>
							<div class="text">
								${data.timeline[i].status}
								${!data.timeline[i].gambar ? "" : `<br><img src="/kurir/gambar-paket/${data._id}/${data.timeline[i].gambar}" width="100px" height="100px">`} 
							</div>
							</div>
						</div>`;
					}

					$('.activity-list').html(activity_html);

					// sign a onclick on #btn-batalkan-paket
					$('#btn-batalkan-paket').attr('onclick', `batalkan_pengiriman('${data._id}')`);

					// sign a onclick on #btn-tugaskan-kurir
					$('#btn-tugaskan-kurir').attr('onclick', `tugaskan_kurir('${data._id}')`);


					// data kurir
					if (data.nama_kurir) {
						$("#input_kurir").val(data.nama_kurir);
						$("#label-kurir-ditugaskan").html(`Kurir Yang Ditugaskan <i
									style="text-decoration: underline;color: blue">(Klik Untuk Melihat Info
									Kurir)</i> `);
						$("#div-data-kurir").attr("onclick", `liat_info_kurir('${data.no_telpon_kurir}',false)`);

					} else {
						$("#label-kurir-ditugaskan").html("Tugaskan Kurir");
						$("#div-data-kurir").attr("onclick", null);
					}

					$("#select-kurir").val("").trigger('change');

					$('#modal-paket').modal({
						backdrop: 'static',
						keyboard: false  // Optional: prevents closing via Esc key
					});
				},
				error: function (xhr, status, error) {
					console.error('AJAX error:', error);
				}
			});
		}

		function batalkan_pengiriman(id) {
			// Hide the modal first
			$('#modal-paket').modal('hide');

			swal({
				title: "",
				text: "Silakan tulis alasan pembatalan:",
				type: "input",
				showCancelButton: true,
				closeOnConfirm: false,
				animation: "slide-from-top",
				inputPlaceholder: "Contoh: Kurir tidak tersedia",
				confirmButtonColor: "#304ffe"
			}, function (inputValue) {
				if (inputValue === false) {
					$('#modal-paket').modal('show');
					return false;
				}
				if (inputValue === "") {
					swal("Oops!", "Alasan tidak boleh kosong!", "error");
					// open the modal again
					$('#modal-paket').modal('show');
					return false;
				}

				// close the swal
				swal.close();
				console.log(inputValue);

				$.ajax({
					url: '/admin/batalkan-pengiriman',
					type: 'DELETE',
					data: {
						id: id,
						alasan: inputValue
					},
					beforeSend: function () {
						blockUI("Melakukan Pembatalan Pengiriman...");
					},
					complete: function () {
						$.unblockUI();
					},
					success: function (data) {
						// Hide the modal
						$('#modal-paket').modal('hide');
						// destroy table
						$('#tb-paket').DataTable().destroy();
						reloadTable();
						// $.unblockUI();
						swal({
							title: "Berhasil!",
							text: "Pengiriman Berhasil Dibatalkan",
							type: "success",
							timer: 2000, // time in milliseconds (2000ms = 2 seconds)
							showConfirmButton: false
						});
					},
					error: function (xhr, status, error) {
						// console.error('AJAX error:', error);
						$('#modal-paket').modal('show');
						console.log(xhr.responseJSON);
						toastr.error(xhr.responseJSON !== undefined ? xhr.responseJSON : "Terjadi Kesalahan Server");
					}
				});
			});





		}


		async function tugaskan_kurir(id) {
			// Hide the modal first
			$('#modal-paket').modal('hide');

			const kurir_data = $('#select-kurir').val();


			if (kurir_data == null || kurir_data == "") {
				// open the modal again
				toastr.error("Kurir Tidak Boleh Kosong");
				// await 2 sec
				await new Promise(resolve => setTimeout(resolve, 500));
				$('#modal-paket').modal('show');
				// $('#select-kurir').focus();
				return
			}

			const id_kurir = kurir_data.split('-')[0];
			const nama_kurir = kurir_data.split('-')[1];
			// console.log(id_kurir, nama_kurir);

			swal({
				title: "Tugaskan Kurir",
				text: "Anda Akan Menugaskan Kurir " + nama_kurir + " Untuk Pengiriman Dengan No Resi " + id + "?",
				type: "info",
				showCancelButton: true,
				closeOnConfirm: false,
				animation: "slide-from-top",
				confirmButtonColor: "#304ffe"
			}, function (isConfirm) {
				if (isConfirm) {
					swal.close();
					$.ajax({
						url: '/admin/tugaskan-kurir',
						type: 'POST',
						data: {
							id_kiriman: id,
							id_kurir: id_kurir
						},
						beforeSend: function () {
							blockUI("Menugaskan Kurir...");
						},
						complete: function () {
							// close all swal
							// swal.close();
							$.unblockUI();
						},
						success: function (data) {
							console.log(data);
							// Hide the modal
							$('#modal-paket').modal('show');
							open_modal_paket(id);
							// // destroy table
							// $('#tb-paket').DataTable().destroy();
							// reloadTable();
							// // $.unblockUI();
							swal({
								title: "Berhasil!",
								text: "Pengiriman Berhasil Ditugaskan",
								type: "success",
								timer: 2000, // time in milliseconds (2000ms = 2 seconds)
								showConfirmButton: false
							});
						},
						error: function (xhr, status, error) {
							// console.error('AJAX error:', error);
							$('#modal-paket').modal('show');
							console.log(xhr.responseJSON);
							toastr.error(xhr.responseJSON !== undefined ? xhr.responseJSON : "Terjadi Kesalahan Server");
						}
					});
				} else {
					// open the modal again
					$('#modal-paket').modal('show');
				}
			})
		}

		function liat_info_kurir(nomor_telpon_kurir, stat) {
			// console.log(stat)


			// close modal-paket 
			$('#modal-paket').modal('hide');
			console.log(nomor_telpon_kurir)
			selectClicked = false

			$("#button-close-modal-kurir").attr("onclick", `close_modal_kurir(${stat})`);
			$.ajax({
				type: 'GET',
				url: '/admin/kurir/' + nomor_telpon_kurir,
				dataType: 'json',
				beforeSend: function () {
					blockUI('Loading')
				},
				complete: function () {
					$.unblockUI();
				},

				success: function (data) {
					console.log(data)
					$('#modal-kurir-title').html('Detail Kurir')
					// hide form-gambar div
					$("#form-gambar-kurir").attr("hidden", true);
					$("#form-gambar-motor").attr("hidden", true);
					$("#no_telpon-kurir").val(data.no_telpon)
					$("#nama-kurir").val(data.nama)
					$("#jenis-kelamin-kurir").val(data.jenis_kelamin)
					$("#dd-motor-kurir").val(data.dd_motor)
					// disable all input in #form-modal

					enableInput(true)

					var img = document.createElement('img');
					img.src = 'admin/kurir/gambar/' + data.no_telpon + '/' + data.gambar_kurir;
					img.style.maxWidth = '100%'; // Make the image fit the width of the div
					img.style.maxHeight = '100%'; // Make the image fit the height of the div

					// Get the preview div
					var previewDiv = document.getElementById('preview-gambar-kurir');
					$('#show-upload-gambar-kurir').show();
					// Clear any existing content in the preview div
					previewDiv.innerHTML = '';

					// Append the image to the preview div
					previewDiv.appendChild(img);

					var img = document.createElement('img');
					img.src = 'admin/kurir/gambar/' + data.no_telpon + '/' + data.gambar_motor;
					img.style.maxWidth = '100%'; // Make the image fit the width of the div
					img.style.maxHeight = '100%'; // Make the image fit the height of the div

					// Get the preview div
					var previewDiv = document.getElementById('preview-gambar-motor');
					$('#show-upload-gambar-motor').show();
					// Clear any existing content in the preview div
					previewDiv.innerHTML = '';

					// Append the image to the preview div
					previewDiv.appendChild(img)

					$('#modal-kurir').modal({
						backdrop: 'static',
						keyboard: false  // Optional: prevents closing via Esc key
					});

				},
				error: function (xhr, status, error) {
					// console.error('AJAX error:', error);
					// $('#modal-paket').modal('show');
					console.log(xhr.responseJSON);
					toastr.error(xhr.responseJSON !== undefined ? xhr.responseJSON : "Terjadi Kesalahan Server");
				}
			})



		}

		function close_modal_kurir(stat) {
			console.log(stat, "ini di close modal kurir")
			$('#modal-kurir').modal('hide');

			// 1.5 sec then open modal
			setTimeout(function () {
				$('#modal-paket').modal('show');
				if (stat) {
					console.log("jalankan stat")
					// enable select
					$("#select-kurir").attr("disabled", false);
				}
			}, 500);
			// reloadTable(id);
		}

		$('#select-kurir').on('select2:select', function (e) {
			const value = e.params.data.id;
			const no_telpon_kurir = value.split('-')[2]
			console.log(no_telpon_kurir)
			liat_info_kurir(no_telpon_kurir, true)
		});

		// function selectKurir(ini) {
		// 	const data = ini.value
		// 	const no_telpon_kurir = data.split('-')[2]
		// 	console.log(no_telpon_kurir)
		// 	liat_info_kurir(no_telpon_kurir, true)

		// }

	</script>
</body>

</html>